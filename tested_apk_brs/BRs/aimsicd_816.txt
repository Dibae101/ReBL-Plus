App Name: AIMSICD (Android IMSI Catcher Detector)

Bug Report Title:
App crashes when requesting OpenCellID API key from Settings

Bug Report Issue:
AIMSICD crashes immediately when user tries to request an OpenCellID API key from the Settings menu. The app crashes with ActivityNotFoundException due to a package name mismatch in the AndroidManifest.xml.

### DESCRIPTION
When attempting to request an OpenCellID API key through Settings, the app crashes with "Unfortunately, AIMSICD has stopped" error. The crash also occurs when using other database features like "Add new strings" and "Delete SMS".

### STEPS TO REPRODUCE
1. Open AIMSICD app
2. Tap the menu button (three dots menu)
3. Select "Settings"
4. Scroll down to the bottom of the Settings page to locate the "OpenCellID Settings" section
5. Find and click on "Request OpenCellID API Key" option under OpenCellID Settings
6. App crashes immediately with ActivityNotFoundException

### EXPECTED BEHAVIOR
The OpenCellID API key request screen should open, allowing the user to request an API key.

### ACTUAL BEHAVIOR
App crashes with "Unfortunately, AIMSICD has stopped" error. ActivityNotFoundException is thrown because the app cannot find the OpenCellIdActivity.

### ENVIRONMENT
AIMSICD version: Debug build (pre-fix version)
Android version: 6.0 (Marshmallow) / 5.0 (Lollipop)
Device: Multiple devices with CyanogenMod

### LOGCAT
ActivityNotFoundException: Unable to find explicit activity class
java.lang.IllegalArgumentException: Unknown component

Crash Details:

**Crash 1 - ActivityNotFoundException**:
```
03-31 16:13:02.783 E AndroidRuntime: FATAL EXCEPTION: main
03-31 16:13:02.783 E AndroidRuntime: Process: com.SecUpwN.AIMSICD, PID: 5686
03-31 16:13:02.783 E AndroidRuntime: android.content.ActivityNotFoundException: 
    Unable to find explicit activity class {com.SecUpwN.AIMSICD/com.secupwn.aimsicd.activities.OpenCellIdActivity}; 
    have you declared this activity in your AndroidManifest.xml?
03-31 16:13:02.783 E AndroidRuntime: at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1801)
03-31 16:13:02.783 E AndroidRuntime: at android.app.Instrumentation.execStartActivity(Instrumentation.java:1514)
03-31 16:13:02.783 E AndroidRuntime: at android.app.Activity.startActivityForResult(Activity.java:3930)
03-31 16:13:02.783 E AndroidRuntime: at android.support.v4.app.FragmentActivity.startActivityForResult(FragmentActivity.java:784)
03-31 16:13:02.783 E AndroidRuntime: at android.app.Activity.startActivity(Activity.java:4213)
03-31 16:13:02.783 E AndroidRuntime: at android.preference.Preference.performClick(Preference.java:1012)
03-31 16:13:02.783 E AndroidRuntime: at android.preference.PreferenceScreen.onItemClick(PreferenceScreen.java:214)
```

**Crash 2 - NullPointerException**:
```
03-21 20:28:51.929 E AndroidRuntime: FATAL EXCEPTION: main
03-21 20:28:51.929 E AndroidRuntime: Process: com.SecUpwN.AIMSICD, PID: 28125
03-21 20:28:51.929 E AndroidRuntime: java.lang.NullPointerException: 
    Attempt to invoke virtual method 'android.view.View android.view.View.findViewById(int)' on a null object reference
03-21 20:28:51.929 E AndroidRuntime: at com.secupwn.aimsicd.fragments.DeviceFragment.updateUI(DeviceFragment.java:132)
03-21 20:28:51.929 E AndroidRuntime: at com.secupwn.aimsicd.fragments.DeviceFragment.access$200(DeviceFragment.java:47)
03-21 20:28:51.929 E AndroidRuntime: at com.secupwn.aimsicd.fragments.DeviceFragment$1.onServiceConnected(DeviceFragment.java:109)
03-21 20:28:51.929 E AndroidRuntime: at android.app.LoadedApk$ServiceDispatcher.doConnected(LoadedApk.java:1224)
```

**Crash 3 - StringIndexOutOfBoundsException (Airplane Mode + WiFi)**:
```
03-31 17:23:37.726 E AndroidRuntime: FATAL EXCEPTION: main
03-31 17:23:37.726 E AndroidRuntime: Process: com.SecUpwN.AIMSICD, PID: 9493
03-31 17:23:37.726 E AndroidRuntime: java.lang.StringIndexOutOfBoundsException: 
    length=0; regionStart=0; regionLength=30
03-31 17:23:37.726 E AndroidRuntime: at java.lang.String.startEndAndLength(String.java:298)
03-31 17:23:37.726 E AndroidRuntime: at java.lang.String.substring(String.java:1087)
03-31 17:23:37.726 E AndroidRuntime: at com.secupwn.aimsicd.ui.activities.MainActivity.downloadBtsDataIfApiKeyAvailable(MainActivity.java:313)
03-31 17:23:37.726 E AndroidRuntime: at com.secupwn.aimsicd.ui.activities.MainActivity.selectDrawerItem(MainActivity.java:267)
03-31 17:23:37.726 E AndroidRuntime: at com.secupwn.aimsicd.ui.activities.MainActivity$DrawerItemClickListener.onItemClick(MainActivity.java:214)
```

- Exception Types: IllegalArgumentException (ActivityNotFoundException), NullPointerException, StringIndexOutOfBoundsException
- Affected Versions: AIMSICD WIP v0.1.41-alpha (before fix)
- Devices Affected: 
  - Sony Xperia V (lt25i) - Lollipop - CyanogenMod
  - Samsung Galaxy S4 Mini - CyanogenMod 13 (Marshmallow)
  - Nexus 6 - Android 6.0 (MMB29V)
- Frequency: 100% reproducible on all database operations

Technical Analysis:

**The Package Name Mismatch**:
In AndroidManifest.xml, after PR #812:
```xml
<manifest package="com.secupwn.aimsicd" ...>
    <!-- Activities still declared with old package path -->
    <activity android:name="com.secupwn.aimsicd.activities.OpenCellIdActivity" />
</manifest>
```

Android constructs component names by combining:
1. Application package name (from manifest root): `com.SecUpwN.AIMSICD`
2. Activity class name (from activity declaration): `com.secupwn.aimsicd.activities.OpenCellIdActivity`

Result: `com.SecUpwN.AIMSICD/com.secupwn.aimsicd.activities.OpenCellIdActivity` (invalid)

When Android tries to launch OpenCellIdActivity via Intent:
```java
Intent intent = new Intent(context, OpenCellIdActivity.class);
startActivity(intent);
```

Android uses the manifest package name to resolve the component, but the case mismatch causes it to fail.

**Why PR #812 Caused This**:
PR #812 changed the package name from `com.SecUpwN.AIMSICD` to `com.secupwn.aimsicd` to fix issue #810, but didn't update all references consistently. This is a common refactoring error when changing package names - all references in the manifest, build.gradle, and code must be updated together.

**The NullPointerException Issue**:
After the activity launch fails, the app attempts to reconnect services. DeviceFragment.updateUI() tries to call findViewById() on a null view reference because the fragment's view was never properly created due to the failed activity launch.

**The StringIndexOutOfBoundsException Issue**:
In airplane mode with WiFi enabled, the app tries to parse API key or network response strings. When the API key is empty or network response is empty, substring() is called with invalid indices (trying to get 30 characters from a 0-length string), causing the crash.

Related Commits and PRs:
- Issue #810: Original issue that prompted package name change
- PR #812: Changed package name but caused this issue
- PR #821: First attempt to fix (not fully successful)
- PR #829: Final fix that resolved all crashes

Impact:
- Severity: Critical - Multiple core features completely broken
- Frequency: 100% on all devices and Android versions
- Affected Components: 
  - OpenCellID API key management
  - Database string management
  - SMS tracking and deletion
  - OCID data download/upload
  - Preference activities
  - Fragment lifecycle management
- User Impact: App is essentially unusable for database operations, defeating the core purpose of IMSI catcher detection which relies heavily on cell tower database functionality
- Workaround: Revert to version before PR #812, but this reintroduces issue #810

Use Case Context:
AIMSICD is a security/privacy app designed to detect fake cell towers (IMSI catchers) used for surveillance. The app relies on comparing current cell tower data with the OpenCellID database. Without the ability to request API keys, download OCID data, or manage the database, users cannot effectively detect IMSI catchers, making the app non-functional for its intended purpose.

Resolution:
Fixed by mimi89999 in PR #829 on March 31, 2016: "Fix issue when requesting an OpenCellId key"
Confirmed working by Nordlenning on April 1, 2016.

The fix involved:
1. Ensuring consistency between package name declaration and activity references in AndroidManifest.xml
2. Either reverting the package name change or updating all activity references to match the new lowercase package name
3. Fixing null reference checks in DeviceFragment.updateUI()
4. Adding proper string length validation before substring operations in MainActivity.downloadBtsDataIfApiKeyAvailable()

Files Changed:
- AndroidManifest.xml: Updated activity declarations to match package name
- DeviceFragment.java: Added null checks for view references
- MainActivity.java: Added string length validation before substring operations

Testing Results:
After fix (v0.1.41-alpha compiled April 1, 2016):
- ✓ "Ask for OpenCell API Key" - Solved
- ✓ "Add new strings" - Works, Solved
- ✓ "Delete SMS" - Works, Solved
- ✓ Works smooth and fine
- User feedback: "Excellent work" from Nordlenning

Alternative Solutions:
1. **Revert package name change**: Simple but reintroduces issue #810
2. **Comprehensive refactoring**: Update all references in manifest, build files, and code
3. **Use applicationId in Gradle**: Separate applicationId from package name in build.gradle
4. **Automated refactoring tools**: Use IDE refactoring to ensure all references are updated

Best Practices Violated:
- Incomplete refactoring when changing package names
- Missing null checks for view references
- No input validation before string operations
- Lack of integration testing after package name changes

Lessons Learned:
- Package name changes require comprehensive updates across all configuration files
- Always verify AndroidManifest.xml activity declarations match package name
- Add null checks when accessing view references in fragments
- Validate string lengths before substring operations
- Test all major features after refactoring operations
- Consider using Android Studio's refactoring tools for package name changes

Note: AIMSICD is now maintained by CellularPrivacy organization. The app helps protect user privacy by detecting suspicious cell tower activity that could indicate IMSI catcher surveillance devices.
