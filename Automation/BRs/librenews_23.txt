Title: NullPointerException when toggling auto-refresh after navigation

App: LibreNews
Package Name: app.librenews.io.librenews
Issue: https://github.com/milesmcc/LibreNews-Android/issues/23

Description:
The LibreNews app crashes with a NullPointerException when a user toggles the "Automatically refresh" setting after navigating to an external browser and returning to the app. The crash occurs because the code attempts to invoke getContext() on a null View object in the settings fragment's preference change listener. This is a lifecycle-related bug where the view becomes null after the user navigates away and returns.

Root Cause:
The bug is in SettingsActivityFragment.java at line 26 in the onSharedPreferenceChanged() callback. When the user navigates to the LibreNews website via the INFO screen and then returns to the app, the fragment's view lifecycle is disrupted. The preference change listener attempts to access the view's context, but the view has become null because the fragment's view was destroyed when the user left the app. The listener remains registered and fires when preferences change, but the view reference is no longer valid.

Steps to Reproduce:
1. Install LibreNews v1.4 from F-Droid
2. Launch the app
3. Navigate to settings and enable "Automatically refresh"
4. Click "INFO" button
5. Click "GO TO LIBRENEWS" button (opens browser)
6. Press the BACK button to return to the app
7. In settings, disable "Automatically refresh"
8. Observe the app crashes with NullPointerException

Expected Behavior:
The app should handle the preference change gracefully even after the user has navigated away and returned. The settings fragment should either:
1. Check if the view is null before accessing it
2. Properly unregister and re-register preference listeners based on fragment lifecycle
3. Use the activity context instead of view context when available

Actual Behavior:
The app crashes immediately when toggling the "Automatically refresh" setting after returning from the external browser, making the app unusable until it's restarted.

Crash Details:
- Exception Type: java.lang.NullPointerException
- Error Message: Attempt to invoke virtual method 'android.content.Context android.view.View.getContext()' on a null object reference
- Location: app.librenews.io.librenews.views.SettingsActivityFragment.onSharedPreferenceChanged(SettingsActivityFragment.java:26)
- Device: Reproduced on Android Studio Emulator (x86, Android 6.0) and Nexus 5 Phone (Android 6.0.1)

Stack Trace:
```
java.lang.NullPointerException: Attempt to invoke virtual method 'android.content.Context android.view.View.getContext()' on a null object reference
    at app.librenews.io.librenews.views.SettingsActivityFragment.onSharedPreferenceChanged(SettingsActivityFragment.java:26)
    at android.app.SharedPreferencesImpl$EditorImpl.notifyListeners(SharedPreferencesImpl.java:479)
    at android.app.SharedPreferencesImpl$EditorImpl.apply(SharedPreferencesImpl.java:387)
    at android.preference.Preference.tryCommit(Preference.java:1415)
    at android.preference.Preference.persistBoolean(Preference.java:1681)
    at android.preference.TwoStatePreference.setChecked(TwoStatePreference.java:81)
    at android.preference.TwoStatePreference.onClick(TwoStatePreference.java:66)
    at android.preference.Preference.performClick(Preference.java:994)
    at android.preference.PreferenceScreen.onItemClick(PreferenceScreen.java:214)
    at android.widget.AdapterView.performItemClick(AdapterView.java:310)
    at android.widget.AbsListView.performItemClick(AbsListView.java:1145)
    at android.widget.AbsListView$PerformClick.run(AbsListView.java:3042)
    at android.widget.AbsListView$3.run(AbsListView.java:3879)
    at android.os.Handler.handleCallback(Handler.java:739)
    at android.os.Handler.dispatchMessage(Handler.java:95)
    at android.os.Looper.loop(Looper.java:148)
    at android.app.ActivityThread.main(ActivityThread.java:5417)
    at java.lang.reflect.Method.invoke(Native Method)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:726)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:616)
```

Technical Analysis:
The issue is a classic Android fragment lifecycle problem. The call chain is:
1. User toggles preference (TwoStatePreference.onClick)
2. Preference persists boolean value (persistBoolean)
3. SharedPreferences notifies listeners (notifyListeners)
4. SettingsActivityFragment.onSharedPreferenceChanged is called
5. Code attempts to call getView().getContext() but getView() returns null

The fragment's view was destroyed when the user navigated to the browser, but the preference listener wasn't unregistered. When the user returns and changes a preference, the listener fires but the view is no longer available.

Proposed Solutions:
1. Add null check before accessing view:
   ```java
   @Override
   public void onSharedPreferenceChanged(SharedPreferences prefs, String key) {
       View view = getView();
       if (view != null) {
           Context context = view.getContext();
           // ... rest of logic
       }
   }
   ```

2. Use getActivity() instead of getView().getContext():
   ```java
   Context context = getActivity();
   if (context != null) {
       // ... use context
   }
   ```

3. Properly manage listener lifecycle by unregistering in onPause/onStop and re-registering in onResume.

Impact:
- Severity: High - Complete app crash
- Frequency: 100% when following the specific navigation pattern
- Affected Component: SettingsActivityFragment, preference change handling
- User Impact: Users cannot change settings after navigating to external links and returning to the app

Note: This repository was archived on December 24, 2021, and is now read-only. The issue remains open and unfixed.
